import{G as e,H as t,J as l,g as a,K as r,N as o,O as n,l as s,e as i,P as u,B as c,q as p,t as d,Q as v,U as f,V as b,W as y,n as g}from"./index.59e593d7.js";import{f as m,a as h,j as O,C as j,n as x,r as P}from"./vendor.b3232dc0.js";import{P as w}from"./pagination.c724356e.js";var S=Object.defineProperty,B=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,A=(e,t,l)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,C=(e,t)=>{for(var l in t||(t={}))_.call(t,l)&&A(e,l,t[l]);if(B)for(var l of B(t))I.call(t,l)&&A(e,l,t[l]);return e};const D={page:1,perPage:10,firstPage:1,lastPage:1,total:0},k=e({remote:Boolean,items:{type:Array,default:()=>[]},mustSort:Boolean,multiSort:Boolean,sortBy:{type:[String,Array],default:()=>[]},sortDesc:{type:[Boolean,Array],default:()=>[]},customSort:{type:Function,default:t},locale:{type:String,default:"en-US"},pagination:{type:Object,defualt:()=>C({},D)}},"data-iterator");function N(e){const t=l("useDataIterator"),n=a(e,"pagination",C({},D),(t=>{var l,a,r,o,n;const s=e.remote?Number(null!=(l=null==t?void 0:t.total)?l:e.items.length):e.items.length,i=Number(null!=(a=null==t?void 0:t.perPage)?a:D.perPage),u=Number(null!=(r=null==t?void 0:t.lastPage)?r:~~(s/i));return m({page:Number(null!=(o=null==t?void 0:t.page)?o:D.page),perPage:i,firstPage:Number(null!=(n=null==t?void 0:t.firstPage)?n:D.firstPage),lastPage:u,total:s})})),s=a(e,"sortBy"),i=a(e,"sortDesc");function u(){t.emit("update:options",{pagination:n.value,sortBy:s.value,sortDesc:i.value})}return{items:h((()=>{if(e.remote)return e.items;let t=e.items.slice();return t=function(t){return e.customSort(t,r(s.value),r(i.value),e.locale)}(t),t=function(e){return e.slice((n.value.page-1)*n.value.perPage,Math.min(n.value.total,n.value.page*n.value.perPage))}(t),t})),pagination:n,sortBy:s,sortDesc:i,sort:function(t){if(Array.isArray(t))i.value=t.map((e=>{const t=r(s.value).findIndex((t=>t===e));return t>-1&&r(i.value)[t]})),s.value=t,u();else{const l=function(e,t,l,a,r,n){let s=t.slice(),i=l.slice();const u=s.findIndex((t=>t===e));return u<0?(n||(s=[],i=[]),s.push(e),i.push(!1)):u>=0&&!i[u]?i[u]=!0:r?i[u]=!1:(s.splice(u,1),i.splice(u,1)),o(s,t)&&o(i,l)||(a=1),{by:s,desc:i,page:a}}(t,r(s.value),r(i.value),n.value.page,e.mustSort,e.multiSort);s.value=l.by,i.value=l.desc,n.value.page=l.page,u()}},updateOptions:u}}var $=Object.defineProperty,T=Object.getOwnPropertySymbols,V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable,E=(e,t,l)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;function U(e){return n(e,Object.keys(L.props))}const H=e(((e,t)=>{for(var l in t||(t={}))V.call(t,l)&&E(e,l,t[l]);if(T)for(var l of T(t))W.call(t,l)&&E(e,l,t[l]);return e})({rowIndex:Number,colIndex:Number,cols:Number,fixed:[Boolean,String],align:{type:String,default:"start"}},s({tag:"td"})),"table-cell"),L=i({name:"VeTableCell",props:H(),setup(e,{slots:t}){const l=h((()=>"string"==typeof e.fixed?e.fixed:!(!e.fixed||void 0===e.colIndex||void 0===e.cols)&&(e.colIndex<(e.cols-1)/2?"start":"end")));return()=>O(e.tag,{class:["ve-table-cell",`text-${e.align}`,{"ve-table-cell--fixed-start":"start"===l.value,"ve-table-cell--fixed-end":"end"===l.value}]},{default:()=>{var e;return[O("div",{class:"ve-table-cell__overlay"},null),null==(e=t.default)?void 0:e.call(t)]},_:1},8,["class"])}});var K=Object.defineProperty,z=Object.getOwnPropertySymbols,R=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable,F=(e,t,l)=>t in e?K(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;const G=i({name:"VeTableTd",props:((e,t)=>{for(var l in t||(t={}))R.call(t,l)&&F(e,l,t[l]);if(z)for(var l of z(t))q.call(t,l)&&F(e,l,t[l]);return e})({sorted:Boolean},H()),setup(e,{slots:t}){const[l]=U(e);return()=>{return O(L,x(l,{class:{"ve-table-td":!0,"ve-table-td--sorted":e.sorted},tag:"td"}),"function"==typeof(a=t)||"[object Object]"===Object.prototype.toString.call(a)&&!j(a)?t:{default:()=>[t],_:2},16,["class"]);var a}}});var J=Object.defineProperty,M=Object.getOwnPropertySymbols,Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,Y=(e,t,l)=>t in e?J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l;const Z=i({name:"VeTableTh",props:((e,t)=>{for(var l in t||(t={}))Q.call(t,l)&&Y(e,l,t[l]);if(M)for(var l of M(t))X.call(t,l)&&Y(e,l,t[l]);return e})({sortable:Boolean,sortDesc:Boolean,sortIcon:{type:String,default:"$sort"},sortActiveColor:{type:String,default:"primary"},filterIcon:{type:String,default:"$filter"},filters:{type:Array,default:()=>[]}},H()),setup:(e,{slots:t})=>()=>{const[l]=U(e);return O(L,x(l,{tag:"th",class:{"ve-table-th":!0,"ve-table-th--sortable":e.sortable,"ve-table-th--sorted":void 0!==e.sortDesc}}),{default:()=>{var l;return[O("div",{class:"ve-table-th__wrap"},[null==(l=t.default)?void 0:l.call(t),e.sortable&&O(u,{class:{"ve-table-th__sorter":!0,"ve-table-th__sorter--desc":!0===e.sortDesc},size:"1em",icon:e.sortIcon,color:void 0!==e.sortDesc?e.sortActiveColor:void 0},null,8,["class","icon","color"])]),e.filters.length>0&&O(c,{class:"ve-table-th__filter",icon:e.filterIcon,variant:"text",onClick:e=>{e.stopPropagation()}},null,8,["icon","onClick"])]},_:1},16,["class"])}});const ee=i({name:"VeTableNoData",props:{icon:{type:String,default:"$nodata"},text:{type:String,default:"暂无数据"}},setup:(e,{slots:t})=>()=>{var l,a;return O("div",{class:"ve-table-no-data"},[O(u,{icon:e.icon,size:48,class:"mb-3"},null,8,["icon"]),O("div",null,[null!=(a=null==(l=t.default)?void 0:l.call(t))?a:e.text])])}});var te=Object.defineProperty,le=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable,oe=(e,t,l)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,ne=(e,t)=>{for(var l in t||(t={}))ae.call(t,l)&&oe(e,l,t[l]);if(le)for(var l of le(t))re.call(t,l)&&oe(e,l,t[l]);return e};const se=i({name:"VeTable",props:ne(ne({hideBorder:Boolean,hideHeader:Boolean,fixedHeader:Boolean,headers:{type:Array,default:()=>[]},sortIcon:{type:String,default:"$sort"},sortActiveColor:{type:String,default:"primary"},loading:Boolean,itemKey:{type:String,default:"id"},hidePagination:Boolean},k()),p({border:!0})),emits:{"update:pagination":e=>!0,"update:sortBy":e=>!0,"update:sortDesc":e=>!0,"update:options":e=>!0},setup(e,{slots:t,emit:l}){const a=P(),o=P(0),{paperClasses:s,paperStyles:i}=d(e,"ve-table__wrapper"),{items:u,pagination:c,sortBy:p,sortDesc:m,sort:j,updateOptions:S}=N(e),B=h((()=>r(p.value))),_=h((()=>r(m.value))),I=h((()=>a.value&&0===o.value?"ve-table--scroll-position-start":a.value&&o.value+a.value.offsetWidth>=a.value.scrollWidth?"ve-table--scroll-position-end":"ve-table--scroll-position-center"));function A(e){const t=e.target;t.scrollLeft!==o.value&&(o.value=t.scrollLeft)}function C(e){return _.value[B.value.findIndex((t=>t===e.value))]}return v((()=>{const l=!t.colgroup&&e.headers.length>0,r=!t.header&&!e.hideHeader&&e.headers.length>0,o=!t.default,p=o&&!e.hidePagination;return O(e.tag,{class:["ve-table",{"ve-table--fixed-header":e.fixedHeader},I.value]},{default:()=>{var d,v,m,h,P;return[O("div",{ref:a,onScroll:f(A,128),class:["ve-table__wrapper",s.value],style:[i.value]},[O("table",null,[l&&O("colgroup",null,[e.headers.map((e=>O("col",function(e){var t,l;return{style:{width:g(e.width),minWidth:g(null!=(t=e.minWidth)?t:e.width),maxWidth:g(null!=(l=e.maxWidth)?l:e.width)}}}(e),null,16)))]),null==(d=t.colgroup)?void 0:d.call(t),r&&O("thead",null,[e.loading&&O("tr",{class:"ve-table__progress"},[O("th",{colspan:e.headers.length},[O(b,{color:"primary",indeterminate:!0,"stroke-width":3},null,8,["indeterminate"])],8,["colspan"])]),O("tr",null,[e.headers.map(((l,a)=>{return O(Z,x((r=l,n(r,Object.keys(Z.props)))[0],{"row-index":0,"col-index":a,cols:e.headers.length,"sort-icon":e.sortIcon,"sort-active-color":e.sortActiveColor,"sort-desc":C(l),onClick:()=>l.sortable&&j(l.value)}),{default:()=>{var e,a,r;return[null!=(r=null!=(a=null==(e=t[`header.${l.value}`])?void 0:e.call(t,{header:l}))?a:l.text)?r:l.value]}},16,["col-index","cols","sort-icon","sort-active-color","sort-desc","onClick"]);var r}))])]),null==(v=t.header)?void 0:v.call(t),o&&O("tbody",null,[u.value.map(((l,a)=>{var r;return O("tr",{key:null!=(r=l[e.itemKey])?r:a},[e.headers.map(((r,o)=>{return O(G,x((s=r,n(s,Object.keys(G.props)))[0],{"row-index":a,"col-index":o,cols:e.headers.length,sorted:void 0!==C(r)}),{default:()=>{var e,a;return[null!=(a=null==(e=t[`item.${r.value}`])?void 0:e.call(t,{item:l}))?a:y(l,r.value)]}},16,["row-index","col-index","cols","sorted"]);var s}))])})),!u.value.length&&O("tr",null,[O("td",{colspan:e.headers.length},[null!=(h=null==(m=t.nodata)?void 0:m.call(t))?h:O(ee,null,null)],8,["colspan"])])]),null==(P=t.default)?void 0:P.call(t)])],46,["onScroll"]),p&&O(w,x({class:"ve-table__pagination"},c.value,{"onUpdate:page":e=>{c.value.page=e,S()},"total-visible":7}),null,16,["onUpdate:page"])]},_:1},8,["class"])})),{exportCSV:function(t){!function(e,t,l,a="utf-8"){const r=[t.map((e=>{var t;return"object"==typeof e?null!=(t=e.text)?t:e.value:e})).join(","),...l.map((e=>t.map((t=>"object"==typeof t?e[t.value]:e[t])).join(",")))],o=new Blob(["\ufeff"+r.join("\n")],{type:`text/csv;charset=${a}`}),n=document.createElement("a");n.setAttribute("href",window.URL.createObjectURL(o)),n.setAttribute("download",`${e}.csv`),n.click()}(t,e.headers,u.value)}}}});export{se as T};
